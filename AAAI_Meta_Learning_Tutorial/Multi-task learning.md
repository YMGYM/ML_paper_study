# AAAI 2021 Meta Learning Tutorial - Multi-task learning

본 파일은 [링크](https://sites.google.com/mit.edu/aaai2021metalearningtutorial/home) 의 영상 내용을 정리해 둔 파일입니다.

개인 공부의 노트 필기용도로 작업했습니다.



## Multi-Task Learning

- DQN : 57개의 아타리 게임을 학습했다.
- 현재는 57개의 아타리 게임들이 인간을 능가하는 수준을 기록하고 있다.
- 머신 러닝을 능가하는 다른 알고리즘들이 존재한다.



- 데이터 (태스크)를 가진  multi-task Learning algorithm이 있는 상태에서 태스크를 예측한다.

- Multi-task 의 예시로는 자율주행이 있다. (차량 탐지, 보행자 탐지, 신호등, 불빛, 커브, 차선...) 

- 이런 다양한 태스크를 수행해야 하는 경우 어떻게 해야 할 것인가?

- 해결책

  - 하나의 신경망으로 여러 태스크? : All-in-O
  - 네트워크를 작업별로 분리
  - 하이브리드
  - 최적화 문제를 합친다.

- 고민해야 할 질문들

  - 각각의 작업끼리 상관관계가 있는가?

  - 가중치 공유는?

  - 네트워크 크기는?

  - 각각의 작업에 할당되는 데이터의 크기는?

  - 태스크가 비슷한건지, 서로 다른것인지..?

    

## Shared Backbone 방법

- 하나의 네트워크를 통과하면서 각각의 작업을 모두 만족하는 구조
- 작업에 대한 손실의 합을 최소화한다. (Linear Scalarization)
  - 단순하다는 장점.
  - 하지만, 가중치 설정, 손실 가중치 설정 등등의 많은 단점 존재
  - 이 방법은 사용하지 않는다.
- 손실값의 가중합을 구해 최소화할 수도 있다.
- 이렇게 하면 효율적인 루틴을 구할 수 있다는 장점이 있지만,
- oversharing이나 negative transfer가 문제가 될 수 있다.



## 각각의 네트워크를 다른 Task에 할당

- 가중치 공유가 없다.
- negative transfer가 없다는 단점
- 비효율적 루틴이나, scale well 되지 않는다는 단점이 존재한다.



## Negative Transfer

- 작업끼리 서로 상관관계
- 한 작업이 다른 작업의 학습을 방해하고, 다른 비율로 학습될 수 있다.
- 그래디언트가 충돌할 수 있다.



## MTL Architecture



### Hard parameter sharing

- 정보를 앞선 레이어로부터 받는다.
- 데이터 $s$에 대해서 모든 태스크의 손실의 합을 최소화한다.
- 일렬로 backbone이 연결되어 있다.

- 다양한 task에 대해 모든 task 의 손실값을 최소화하는 경계선에서 결정된다. (선형계획법과 비슷한 느낌)

  

### Soft parameter sharing

- 추론 과정에서 가중치를 공유한다.

- scale well되지 않음

  

### Ad-hoc sharing

- 일부만 가중치 공유
- 관계있는 작업끼리만 공유한다.
- 앞 두 방법에 비해 성능이 좋은 편

- 파인튜닝이 어렵다. (연결점 때문에 하나의 수정이 크게 바뀐다)

  

### Learn shared Architecture

- 그래프 구조와 어느 정도 비슷..

- 노드는 컴퓨팅 작업, 엣지는 흐르는 데이터이다.
- 데이터가 연결되어있는지를 확인 후 일부에게만 공유.
- 전체를 다 연결시켜놓고 시작한 뒤 가지치기(?)
- Layer Routing이 유명한 방법이다.



## Tasknomy Dataset

- 26개의 다른 작업과 레이블이 있는 데이터셋이다.
- 어떤 알고리즘이 좋은지 테스트가 가능하다.
- 어떤 작업이 함께 학습되어야 할지/되면 안 될지 확인한다.
- 함께 학습했을 때 상대적 성능을 확인해 볼 수 있었다.
- 전이학습은 다중작업을 수행하기는 어려웠다. (성능 차이가 크다) 반면 MTL은 성능 차이가 크지 않게 나타났다.



## Combinatorial Optimization Problem

- 네트워크와 작업 간 Bipartite matching (상호 연결) 을 수행한다.
- 모든 작업을 다 끝낼때 까지의 cost time도 계산한다. (실무에 적합)
- 최적 조건을 찾을때까지 반복해서 수행한다. (어떤 작업끼리 연결할지)

