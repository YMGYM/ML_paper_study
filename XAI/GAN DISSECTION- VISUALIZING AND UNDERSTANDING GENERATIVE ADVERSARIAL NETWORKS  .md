# GAN DISSECTION: VISUALIZING AND UNDERSTANDING GENERATIVE ADVERSARIAL NETWORKS
본 자료는 빅데이터 동아리 Tobigs 12기 안민준의 XAI 심화세미나 활동으로 작성되었습니다.

본 자료는 동명의 [논문](https://arxiv.org/abs/1811.10597) 의 내용을 정리하고 이해하기 위해 작성되었습니다.

출처가 적혀 있지 않은 이미지는 모두 논문의 자료입니다.



## Abstract

- GAN은 샘플의 질을 향상시키고, 학습 안정성을 향상시키는 효과를 얻었다.
- 하지만 GAN이 우리의 시각적 세상을 내부적으로 어떻게 표현하는지에 대한 이해는 부족했다.
- 본 논문은 다른 개념과 밀접하게 관련된 interpretable units을 명시할 것이다.
- 이를 결과물에 대해 간섭할 수 있는 정도로 확인하여 인과관계적 영향을 파악했다.



## Introduction

- GAN은 많은 연구가 있었지만, 몇 가지 질문에 대한 답이 아직 제시되지 않았다.
  - 예를 들어 교회 이미지를 생성하기 위해 어떤 지식을 배워야 하는가..?
  - GAN이 너무 비현실적인 이미지를 생성한다면, 뭐가 문제였는가?
  - 하나의 GAN이 다른 것 보다 성능이 좋은 이유가 무었인가가? 어떤 근본적인 차이가 있었는가
- 이 논문에서는 GAN의 내부 표현을 확인한다.
- 인간 관측자가 볼 때, 잘 학습된 GAN은 이미지의 특정 요소를 학습한 것으로 보인다.
- 이런 요소가 pure pixel patterns로 나타나는가, 또는 GAN이 인간이 해석할 수 없는 내부적 변수를 포함하는가?
- 또한 GAN이 표현할 수 있는 요소 간 관계가 있을까?
- 본 논문은 GAN을 다양한 추상화 환경에서 시각화하고 이해해 본다.



## Method

- 우리의 목표는 GAN 생성자의 내부 표현에서 물체(나무 등)이 어떻게 인코드 되는가를 확인하는 것이다.

- 본 논문에서는 텐서 $r$ 을 GAN의 중간 레이어의 산출물로 나타내겠다.

  - $r = h(z)$ and $ x = f(r) = f(h(z)) = G(z) $

  $ r $ 은 $ X = f(r)$ 을 하기 위한 데이터이기 때문에 $r$ 은 이미지를 특정 클래스이게 하는 핵심 정보를 포함하고 있을 것이다.

- 본 논문은 피처 $r$를 다음 두 부분으로 나눠 연구한다.
  - Dissection : 모든 클래스 $c$와 $r$ 에 대해서 $r$ 안에 explicit representation 을 가진 클래스를 명시한다.
  - Intervention : Dissection에 대해서 인과 관계를 명확히 하고 유닛과 클래스 간 인과적 영향을 파악한다.



### Characterizing Units By Dissection

- 유닛 $u$에 일치하는지의 여부를 IoU 방법을 통해 확인했다.
- 출력값에 해당하는 $r$을 업샘플링하고, 특정 클래스가 포함된 부분을 마스킹한 $s_c (x)$ 와 비교하여 측정하는 방법을 사용했다.



### Measuring Casual Relationships Using Intervention

- $U$를 껐다 켜면서 $c$ 를 생성하는 데 영향을 미치는지를 확인했다.
- 이미지를 제거한 픽셀 $X_a$ , 제거하지 않은(삽입한 픽셀) $X_i$
- Average Casual Effect $\delta_{U \rightarrow c} $ 을 최대화하는 $U$의 조합을 찾는다.
- Optimization 방법을 통해 실험을 진행했다.



## Results

- Progressive GANs 모델을 LSUN 데이터셋에 대해 학습시켜 사용했다.
- 물체를 336 개로 분류할 수 있는데, 이를 top, bottom, left, right 부분으로 더 세분화해서 사용했다.

- GAN이 왜 실패했는지에 대한 분석이 가능했다. (아티팩트를 제거했더니 성능이 매우 향상됐다.)
- 특정 물체를 나타내는 벡터를 제거할 수 있었다. (장면 타입에 따라 안되는 경우도 존재했다.)
- 벡터를 추가해서 특징을 나타내게 하는 방법은 문맥에 따라 다양하게 적용되었다.



## Discussion

- GAN의 많은 부분이 해석될 수 있는 것으로 확인됐다.
- 이 부분들이 output의 합성에 인과적 영향을 미치는 것으로 확인됐다.
- 본 연구가 VAE나 RealNVP 등에도 적용될 수 있다.
- 본 연구는 구별자보다 생성자에 초점을 맞췄다. (생성자가 목표 분포에 근사하는 데 필요한 모든 정보를 포함하기 때문)
- 본 연구는 GAN을 비교하기 위해 만들어지지는 않았다.
- 본 연구는 '왜 문이 하늘에 생성되지 못하는가', 'GAN이 뒷 레이어의 신호를 억압하는가' 등에 대한 질문의 답을 해주지는 못했다.